%option noyywrap
%{
        #include <stdio.h>
        #include <string.h>
        #define SIZE 100
        int flag=0;
        char init_buffer[1000];
%}
%%
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if[\(].*\n { char a[SIZE];
        char var[SIZE];
        bzero(a, SIZE);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        bzero(var, SIZE);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        int j=5, i=3, k=0;
        a[0]='c';
        a[1]='a';
        a[2]='s';
        a[3]='e';
        a[4]=' ';
        while(yytext[i]!='=') {
                var[k]=yytext[i];
                k++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        //printf("\nswitch(%s){ \n", var);
        strcat(init_buffer,"\nswitch(");
        strcat(init_buffer,var);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        strcat(init_buffer,"){\n");
        while(yytext[i]!=')') {
                a[j]=yytext[i];
                i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                j++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        a[j]=':';
        j++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        a[j]='\0';
        if(flag==0) {
                flag=1;
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        else {
                //printf("break;\n");
                strcat(init_buffer,"break;\n");
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       // printf("%s\n", a);
        strcat(init_buffer,a);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        strcat(init_buffer,"\n");
        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
else[ ]if.*\n { char a[SIZE];
        bzero(a, SIZE);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        int j=5, i=8;
        a[0]='c';
        a[1]='a';
        a[2]='s';
        a[3]='e';
        a[4]=' ';
        while(yytext[i]!='=') {
                i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        while(yytext[i]!=')') {
                a[j]=yytext[i];
                i++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                j++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        a[j]=':';
        j++;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        a[j]='\0';
        if(flag==1) {
               // printf("\tbreak;\n");
                strcat(init_buffer,"\tbreak;\n");
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        //printf("%s\n", a);
        strcat(init_buffer,a);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        strcat(init_buffer,"\n");
        }
else[ ]\{\n {//printf("\tbreak;\ndefault: \n");
                strcat(init_buffer,"\tbreak;\ndefault:\n");
            }
[^\}].*\n {//printf("%s", yytext);
                strcat(init_buffer,yytext);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
          }
\}\n {}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
%%
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
int main(int argc, char* argv[]) {
        if(argc>1) {
                FILE *fp = fopen(argv[1], "r");
                if(fp)
                        yyin = fp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        yylex();                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        FILE * fc =fopen("output1.txt","w");
        fprintf(fc,"%s",init_buffer);
        return 0;
}
